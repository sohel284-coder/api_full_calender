{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Lysa Calendar</title>

	<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
	<link rel="stylesheet" href="{% static 'custom.css' %}">

	<link rel="stylesheet" href="{% static 'full_calendar/main.css' %}">



</head>

<body>
	<div class="calendar-wd__section" id="app">
		<div class="calendar-wd">
			<div id='calendar'></div>
			<br>
			<br>
			<div class="calendar-wd__form calendar-wd__form-three" style="display: none;" id="popup">
				<div class="close-icon close-three" @click.prevent="iconClose"><img src="{% static 'img/close.png' %}"
						alt=""></div>
				<div class="calendar-wd__form-three--one">
					<div class="calendar-wd__form-three-head">
						<ul class="list-group calendar-wd__form-three-list" id="list-tab" role="tablist">
							<li><a class="list-group-item" data-bs-toggle="list" href="#f-tab4" role="tab"><img
										src="{% static 'img/pen.png' %}" alt="#"></a></li>
							<li><a class="list-group-item active" data-bs-toggle="list" href="#f-tab3" role="tab"><img
										src="{% static 'img/message.png' %}" alt="#"></a></li>
							<li><a class="list-group-item" data-bs-toggle="list" href="#f-tab5" role="tab"><i
										class="icofont-bread"></i><img src="{% static 'img/bell-2.png' %}" alt="#"></a>
							</li>
						</ul>
						<img style="" src="{% static 'img/calander-banner.png' %}">

					</div>
					<div class="calendar-wd__form-three-body">
						<div class="tab-content" id="nav-tabContent">
							<div class="tab-pane fade show active" id="f-tab3" role="tabpanel">
								<div class="calendar-wd__form-separate-column">
									<div class="calendar-wd__form-three-one">
										<h2 class="calendar-wd__form-three-title">
											<span>[[calendar_name]]</span>[[event_title]]
										</h2>
										<div class="calendar-wd__form-body">
											<div class="calendar-wd__form-single">
												<h4 class="calendar-wd__form-heading"><img
														src="{% static 'img/calender.png' %}"
														alt="#"><span>[[start_time]]</span> <span
														class="ml-2">[[end_time]]</span> </h4>
											</div>
											<div class="calendar-wd__form-single">
												<h4 class="calendar-wd__form-heading"><a href="#"><img
															src="{% static 'img/memo.png' %}" alt="#">[[location]]</a>
												</h4>
												<ul class="calendar-wd__form-list">
													<li>Update sales presentation</li>
													<li>Book large meeting room</li>
													<li>Send material to Keiko Toyama</li>
												</ul>
											</div>
										</div>
									</div>
									<div class="calendar-wd__form-three-two">
										<ul v-for="attendee in attendees"
											class="calendar-wd__form-list-img calendar-wd__form-list-two">
											<li><img src="" alt="#">[[attendee.event_attendee]]</li>

										</ul>
										<div class="calander-wd__button calander-wd__button-guest">
											<span class="plus-icon"><a href="#"><i class="fa fa-plus"></i></span>Add
											guests</a>
										</div>
									</div>

								</div>
							</div>
						</div>

					</div>
				</div>


			</div>

		</div>
	</div>

	<script src="{% static 'js/jquery.min.js' %}"></script>
	<script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>

	<script src="{% static 'js/bootstrap.min.js' %}"></script>
	<script src="{% static '/full_calendar/main.js'%}"></script>

	{% if debug %}
	<script src="{% static 'js/vue.js' %}"></script>
	{% else %}
	<script src="{% static 'js/vue.min.js' %}"></script>
	{% endif %}

	<script>
		var app = new Vue({
			el: '#app',
			delimiters: ['[[', ']]'],
			data: {
				weekly_events: [],
				popup: false,
				event_title: '',
				calendar_name: '',
				attendees: [],
				start_time: '',
				end_time: '',
				location: '',



			},
			mounted: function () {
				this.showEvents();
			},
			methods: {
				iconClose: function () {
					$("#popup").hide();
				},

				showEvents: function () {
					var that = this;
					$.ajax({
						method: 'GET',
						url: 'api/event-filter/' + 'weekly',
					}).then(response => {
						that.weekly_events = response.events;
						that.weeklyCalendar();
						// for (let i = 0; i < that.weekly_events.length; i++) {
						// 	console.log(that.weekly_events[i].calendar_id)
						// 	console.log(color_keys[i]);
						// 	for (let j = 0; j < color_keys.length; j++) {
						// 		if (that.weekly_events[i].calendar_id == color_keys[j]) {
						// 			that.event_color = that.colors[color_keys[i]]
						// 			console.log(that.event_color);
						// 			

						// 		}
						// 	}

						// }
					})
				},

				weeklyCalendar: function () {
					var that = this;
					

					var calendarEl = document.getElementById('calendar');
					var calendar = new FullCalendar.Calendar(calendarEl, {

						headerToolbar: {
							left: 'prev,next today',
							center: 'title',
							right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
						},
						initialDate: '2022-01-13',
						navLinks: true, // can click day/week names to navigate views
						nowIndicator: true,

						weekNumbers: true,
						weekNumberCalculation: 'ISO',

						editable: true,
						selectable: true,
						dayMaxEvents: true,
						events: that.weekly_events,
						// eventColor: that.event_color,
						eventClick: function (event) {
							$('.calendar-wd__form-three').show();


							that.event_title = event.event._def.title;
							that.location = event.event._def.extendedProps.event_location;
							// that.start_time = new Date(event.event.start).toLocaleTimeString();
							// that.end_time = new Date(event.event.end).toLocaleTimeString();


							var minute = new Date(event.event.start).getMinutes().toLocaleString();
							var hour = new Date(event.event.start).getHours().toLocaleString();
							that.start_time = hour+"."+minute;
							var end_min = new Date(event.event.end).getMinutes().toLocaleString();
							var end_hour = new Date(event.event.end).getUTCHours().toLocaleString();
							that.end_time = end_hour+"."+end_min;

							that.calendar_name = event.event._def.extendedProps.calendar_name
							that.attendees = event.event._def.extendedProps.calendar_attendee


							calender_id = event.event._def.extendedProps.calender_id;



						}
					});
					calendar.render();

				}
			},
		})




	</script>


</body>

</html>